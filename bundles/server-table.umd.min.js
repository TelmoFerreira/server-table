!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/common/http"),require("@angular/cdk/overlay"),require("@angular/cdk/portal"),require("@angular/common"),require("@angular/forms")):"function"==typeof define&&define.amd?define("server-table",["exports","@angular/core","@angular/common/http","@angular/cdk/overlay","@angular/cdk/portal","@angular/common","@angular/forms"],e):e((t=t||self)["server-table"]={},t.ng.core,t.ng.common.http,t.ng.cdk.overlay,t.ng.cdk.portal,t.ng.common,t.ng.forms)}(this,(function(t,e,n,o,r,a,i){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var l=function(){return(l=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function s(t,e,n,o){var r,a=arguments.length,i=a<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,o);else for(var l=t.length-1;l>=0;l--)(r=t[l])&&(i=(a<3?r(i):a>3?r(e,n,i):r(e,n))||i);return a>3&&i&&Object.defineProperty(e,n,i),i}function c(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],o=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&o>=t.length&&(t=void 0),{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var p=function(){function t(){}return t.ɵprov=e.ɵɵdefineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t=s([e.Injectable({providedIn:"root"}),c("design:paramtypes",[])],t)}(),u=function(){function t(){this.onToasterDie=new e.EventEmitter,this.progress=100,this.finished=!1}return t.prototype.ngOnInit=function(){this.startCountDown()},t.prototype.startCountDown=function(){var t=this;this.identity=setInterval((function(){t.progress<=0&&(setTimeout((function(){t.finished||t.onToasterDie.emit("timeout")}),1e3),clearInterval(t.identity)),t.progress--}),this.delay/100)},t.prototype.onCancelClick=function(){clearInterval(this.identity),this.finished=!0,this.onToasterDie.emit("stop")},s([e.Output(),c("design:type",Object)],t.prototype,"onToasterDie",void 0),s([e.Input(),c("design:type",String)],t.prototype,"message",void 0),s([e.Input(),c("design:type",String)],t.prototype,"color",void 0),s([e.Input(),c("design:type",Number)],t.prototype,"delay",void 0),t=s([e.Component({selector:"lib-toaster",template:'<div class="tf-toaster alert alert-{{color}}">\n\t<button type="button" (click)="onCancelClick()" class="btn btn-outline-secondary btn-sm">Cancelar</button>\n\t\t{{message}}\n\t<div class="progress" style="height: 4px;">\n\t\t<div class="progress-bar progress-bar-striped bg-{{color}}" role="progressbar" [style.width]="progress+\'%\'"></div>\n\t</div>\n</div>   \n',styles:[".tf-toaster{width:400px}.tf-toaster button{float:right;margin-left:10px}.alert{position:relative;padding:.75rem 1.25rem;margin-bottom:1rem;border:1px solid transparent;border-radius:.25rem}.alert-heading{color:inherit}.alert-link{font-weight:700}.alert-dismissible{padding-right:4rem}.alert-dismissible .close{position:absolute;top:0;right:0;padding:.75rem 1.25rem;color:inherit}.alert-primary{color:#004085;background-color:#cce5ff;border-color:#b8daff}.alert-primary hr{border-top-color:#9fcdff}.alert-primary .alert-link{color:#002752}.alert-secondary{color:#383d41;background-color:#e2e3e5;border-color:#d6d8db}.alert-secondary hr{border-top-color:#c8cbcf}.alert-secondary .alert-link{color:#202326}.alert-success{color:#155724;background-color:#d4edda;border-color:#c3e6cb}.alert-success hr{border-top-color:#b1dfbb}.alert-success .alert-link{color:#0b2e13}.alert-info{color:#0c5460;background-color:#d1ecf1;border-color:#bee5eb}.alert-info hr{border-top-color:#abdde5}.alert-info .alert-link{color:#062c33}.alert-warning{color:#856404;background-color:#fff3cd;border-color:#ffeeba}.alert-warning hr{border-top-color:#ffe8a1}.alert-warning .alert-link{color:#533f03}.alert-danger{color:#721c24;background-color:#f8d7da;border-color:#f5c6cb}.alert-danger hr{border-top-color:#f1b0b7}.alert-danger .alert-link{color:#491217}.alert-light{color:#818182;background-color:#fefefe;border-color:#fdfdfe}.alert-light hr{border-top-color:#ececf6}.alert-light .alert-link{color:#686868}.alert-dark{color:#1b1e21;background-color:#d6d8d9;border-color:#c6c8ca}.alert-dark hr{border-top-color:#b9bbbe}.alert-dark .alert-link{color:#040505}"]})],t)}(),g=function(){function t(t,e,n){this.httpClient=t,this.overlay=e,this.renderer=n,this.columns=[],this.actions=[],this.service="",this.dataToserver={},this.mainData=[],this.paginacao=[],this.currentPage=1,this.pageSize=10,this.collectionSize=0,this.filtro={},this.paginationCfg={},this.searchInput="",this.countDisabled=0,this.filtro.offset=0,this.paginationCfg.align="end"}return t.prototype.onPageSizeChange=function(t){this.currentPage=1,this.pageSize=event.target.value,this.getData()},t.prototype.onTypeSearchInput=function(){var t=this;this.keyupDelay&&clearTimeout(this.keyupDelay),this.keyupDelay=setTimeout((function(){t.currentPage=1,t.filtro.search=t.searchInput,t.filtro.offset=0,t.getData(),t.keyupDelay=void 0}),500)},t.prototype.getData=function(){var t=this,e=this.service;this.mainData=[],this.filtro.limit=this.pageSize;for(var o=0;o<this.columns.length;o++)if(null!=this.columns[o].order&&""!=this.columns[o].order){this.filtro.order=this.columns[o].key,this.filtro.dir=this.columns[o].order;break}this.filtro=l(l({},this.filtro),this.dataToserver);var r=new n.HttpParams({fromObject:this.filtro});e+=this.service.includes("?")?"&"+r:"?"+r,this.httpClient.get(e).subscribe((function(e){null!=e.data&&Array.isArray(e.data)&&0!=e.data[0]&&(e.data.forEach((function(e,n){e.actions=JSON.parse(JSON.stringify(t.actions));var o=t.applyChangesBeforeRender(e);o.hide=function(){o.hideRow=!0},o.show=function(){o.hideRow=!1},t.mainData.push(o)})),null==e.COUNT&&(e.COUNT=0,console.error("SERVER-TABLE: Pagination needs total results {data:[],COUNT:number}")),t.collectionSize=e.COUNT,t.paginacao=t.paginator())}))},t.prototype.applyChangesBeforeRender=function(t){return null!=this.beforeRender&&t?this.beforeRender(t):t},t.prototype.changeColumnOrder=function(t){if(0==this.countDisabled){null!=this.columns[t].order&&""!=this.columns[t].order?this.columns[t].order="asc"==this.columns[t].order?"desc":"asc":this.columns[t].order="asc";for(var e=0;e<this.columns.length;e++)if(null!=this.columns[e].order&&""!=this.columns[e].order&&e!=t){this.columns[e].order=void 0;break}this.currentPage=1,this.getData()}},t.prototype.ngOnChanges=function(t){var e=this;t.settings&&(this.columns=t.settings.currentValue.columns,this.actions=t.settings.currentValue.actions||[],this.service=t.settings.currentValue.service,this.beforeRender=t.settings.currentValue.beforeRender,this.paginationCfg=t.settings.currentValue.pagination,this.dataToserver=t.settings.currentValue.params(),t.settings.currentValue.params=function(t){e.dataToserver=t,e.getData()},this.getData())},t.prototype.onPaginationClick=function(t){if(0==this.countDisabled){var e=Math.ceil(this.collectionSize/this.pageSize);"first"==t?this.currentPage=1:"last"==t?this.currentPage=e:"backwards"==t?this.currentPage=this.currentPage<=1?1:this.currentPage-1:"foward"==t?this.currentPage=this.currentPage>=e?e:this.currentPage+1:"..."!=t&&(this.currentPage=t),this.filtro.offset=String((this.currentPage-1)*this.pageSize),this.getData()}},t.prototype.paginator=function(){for(var t,e,n,o=Math.ceil(this.collectionSize/this.pageSize),r=this.currentPage,a=o,i=r-2,l=r+2+1,s=[],c=[],p=1;p<=a;p++)(1==p||p==a||p>=i&&p<l)&&s.push(p);try{for(var u=d(s),g=u.next();!g.done;g=u.next()){p=g.value;n&&(p-n==2?c.push(n+1):p-n!=1&&c.push("...")),c.push(p),n=p}}catch(e){t={error:e}}finally{try{g&&!g.done&&(e=u.return)&&e.call(u)}finally{if(t)throw t.error}}return c},t.prototype.onClickButtonOpcoes=function(t,e,n){var o=this;if(e.timestamp=(new Date).getTime(),null==n.disabled||0==n.disabled)if(null!=t.delay){if(!e.disabled){e.disabled=!0,this.countDisabled++;var a=this.overlay.position().global().bottom("10px").centerHorizontally(),i=this.overlay.create({positionStrategy:a,width:"400px"}),l=new r.ComponentPortal(u),s=i.attach(l);s.instance.message=t.delay.msg||"empty",s.instance.color=t.delay.color||"primary",s.instance.delay=t.delay.time||3e3,s.instance.onToasterDie.subscribe((function(r){null!=t.callback&&t.callback({type:r,button:n,data:e}),i.dispose(),delete e.disabled,o.countDisabled--}))}}else null!=t.callback&&t.callback({type:"click",button:n,data:e})},t.prototype.ngOnInit=function(){if(null!=this.settings.moveElementToMiddle&&""!=this.settings.moveElementToMiddle){var t=document.getElementById(this.settings.moveElementToMiddle);null!=t&&this.middleCol.nativeElement.appendChild(t)}},t.ctorParameters=function(){return[{type:n.HttpClient},{type:o.Overlay},{type:e.Renderer2}]},s([e.Input(),c("design:type",Object)],t.prototype,"settings",void 0),s([e.ViewChild("middleCol",{static:!0}),c("design:type",e.ElementRef)],t.prototype,"middleCol",void 0),t=s([e.Component({selector:"serverTable",template:'\n\t<div class="row top-container">\n\t\t<div class="col-lg-2">\n\t\t\t<select class="form-control table-select" (change)="onPageSizeChange($event)">\n\t\t\t\t<option value="10">10</option>\n\t\t\t\t<option value="50">50</option>\n\t\t\t\t<option value="100">100</option>\n\t\t\t\t<option value="500">500</option>\n\t\t\t</select>\n\t\t</div>\n\t\t<div #middleCol class="col">\n\t\t\t\n\t\t</div>\n\t\t<div class="col-lg-2">\n\t\t\t<input class="form-control table-search" [disabled]="countDisabled" type="text" [(ngModel)]="searchInput" (keyup)="onTypeSearchInput()" placeholder="Search" />\n\t\t</div>\n\t</div>\n\n\t<div class="table-responsive">\n\t\t<table class="table table-striped">\n\t\t\t<thead>\n\t\t\t\t<tr class="table-row-header">\n\t\t\t\t\t<th class="table-column-header" *ngFor="let column of columns;let i = index" scope="col" [style.width]="column.width">\n\t\t\t\t\t\t<span class="table-header" [ngClass]="countDisabled ? \'disabled\' : \'\'" style="cursor: pointer;" (click)="changeColumnOrder(i)"> \n\t\t\t\t\t\t\t{{column.title}} \n\t\t\t\t\t\t\t<span [style.opacity]="( column.order != undefined && column.order != \'\' )?\'1\':\'0\'" [ngClass]="column.order" class="order-icons">\n\t\t\t\t\t\t\t\t&#x279C;\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</th>\n\t\t\t\t\t<th *ngIf="actions.length" class="btn-td-container">Actions</th>\n\t\t\t\t</tr>\n\t\t\t</thead>\n\t\t\t\n\t\t\t<tbody>\n\t\t\t\t<tr class="table-row" *ngFor="let data of mainData" [hidden]="data.hideRow"> \n\t\t\t\t\t<td class="table-column" *ngFor="let col of columns;">\n\t\t\t\t\t\t<div *ngIf="col[\'type\'] == \'color\';else default ">\n\t\t\t\t\t\t\t<span class="badge" [style.backgroundColor]="data[col.key]">{{data[col.key]}}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<ng-template #default><div [innerHtml]="data[col.key]"></div></ng-template>\n\t\t\t\t\t</td>\n\n\t\t\t\t\t<td *ngIf="actions.length" class="btn-td-container">\n\t\t\t\t\t\t<span  class="table-action-buttons" title="{{action[\'title\']}}"\n\t\t\t\t\t\t\t*ngFor="let action of actions; let i = index;" \n\t\t\t\t\t\t\t[ngClass]="(data.disabled || data[\'actions\'][i][\'disabled\'])? \'disabled\':\'\'" \n\t\t\t\t\t\t\t[innerHtml]="data[\'actions\'][i][\'html\']" \n\t\t\t\t\t\t\t(click)="onClickButtonOpcoes(action,data,data[\'actions\'][i])"></span>\n\t\t\t\t\t</td>\n\t\t\t\t</tr>\n\t\t\t</tbody> \n\t\t</table>\n\t\t<span class="total-info">Total de {{collectionSize}} registos</span>\n\t\t\x3c!-- <span class="total-info">Mostrar {{filtro[\'offset\']}} até {{filtro[\'limit\']}} de {{collectionSize}} registos</span> --\x3e\n\t\t<ul class="pagination" [ngClass]="paginationCfg[\'align\']">\n\t\t\t<li class="page-item">\n\t\t\t\t<a href="" (click)="onPaginationClick(\'first\');$event.preventDefault()" class="page-link">&#x226A;</a>\n\t\t\t</li>\n\t\t\t<li class="page-item">\n\t\t\t\t<a href="" (click)="onPaginationClick(\'backwards\');$event.preventDefault()" class="page-link">&#x3c;</a>\n\t\t\t</li>\n\t\t\t<li class="page-item" *ngFor="let pag of paginacao" [ngClass]="(pag == currentPage) ? \'active\':\'\'">\n\t\t\t\t<a href="" class="page-link" (click)="onPaginationClick(pag);$event.preventDefault()">{{pag}}</a>\n\t\t\t</li>\n\t\t\t<li class="page-item">\n\t\t\t\t<a href="" (click)="onPaginationClick(\'foward\');$event.preventDefault()" class="page-link">&#x3e;</a>\n\t\t\t</li>\n\t\t\t<li class="page-item">\n\t\t\t\t<a href="" (click)="onPaginationClick(\'last\');$event.preventDefault()" class="page-link">&#x226B;</a>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t',styles:[".total-info{left:26px;position:absolute;bottom:33px}.btn-td-container{text-align:center}.order-icons{display:inline-block;margin-left:3px}.order-icons.asc{transform:rotate(90deg)}.order-icons.desc{transform:rotate(-90deg)}.table-action-buttons{margin-left:8px;margin-right:8px;cursor:pointer}.table-action-buttons.disabled{opacity:.4;cursor:default}.table-action-buttons:hover{opacity:.6}.table-action-buttons:active{opacity:.2}.table-header.disabled{opacity:.6;cursor:default!important}.table-column div{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.pagination{display:flex;justify-content:flex-end;padding-left:0;list-style:none;border-radius:.25rem}.pagination.start{justify-content:flex-start}.pagination.center{justify-content:center}.pagination.end{justify-content:flex-end}.top-container{padding-bottom:20px}.top-container .table-search{float:right;margin-top:0;width:100%}.top-container .table-select{width:100px}.pagination .page-link{text-decoration:none}"]}),c("design:paramtypes",[n.HttpClient,o.Overlay,e.Renderer2])],t)}(),f=function(){function t(){}return t=s([e.NgModule({declarations:[g,u],imports:[a.CommonModule,i.FormsModule,o.OverlayModule],exports:[g]})],t)}();t.ServerTableComponent=g,t.ServerTableModule=f,t.ServerTableService=p,t.ɵa=u,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=server-table.umd.min.js.map